- if @map
  %div{:style => 'float: right;'}
    = @map.div(:width => 350, :height => 300)

- unless @results
  - content_for("page_scripts") do
    :plain
      Event.observe(window, 'load',
        function() { $('address').focus() }
      );

- if !@results.blank?
  %h1 Search Results
  %table.results
    %tr
      %th Name
      %th Address
      %th Miles
    = render :partial => "result", :collection => @results
  %br/
  %br/
- elsif !@closest.blank?
  %h1 No Match
  %p
    No locations matched your search.  However, here is the closest match in
    our database:
  %table.results
    %tr
      %th Name
      %th Address
      %th Miles
    = render :partial => "result", :collection => @closest
  %br/
  %br/

- if @results.blank? && @closest.blank?
  %h1 Search
- else
  %h2 Search again

%p
  Enter a full address, a city and state, or a zip code to find locations to
  play Go in your area.  Your information won't be shared, and the more
  information you provide, the more accurate the search will be.
- form_tag({:action => "radius"}, :method => :get) do
  %table
    %tr
      %td Address, City, State, or Zip:
      %td= text_field_tag :address, @address, :size => 30
    %tr
      %td Radius:
      %td
        %select#radius{:name => "radius"}
          - @radii.each do |radius|
            %option{:selected => radius == @radius}= radius
  = submit_tag 'Search'
%br/
%br/
%h2 Listing by state
- active_countries(true).each do |country|
  .country{:style => "clear: left;"}
    = link_to country.full_name, :controller => :locations, :action => :index, :country => country.full_name.gsub(' ', '-')
  - by_columns(active_states_for(country.abbrev)) do |column|
    .column{:style => 'float: left; width: 120px; padding-bottom: 1em;'}
      - column.each do |state|
        .state
          = link_to state.full_name, :controller => :locations, :action => :index, :country => country.full_name.gsub(' ', '-'), :state => state.full_name.gsub(' ', '-')
